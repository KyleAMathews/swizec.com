export const title = "Module 3"

export const description = ""

export const image = "/chapter_headers/serverless-elements.png"
import { Vimeo } from "../components/Video"

# Upsert users when they login

We start with an example that's mostly handled for us by Auth0, but is still a good way to talk about the basics. You most often want to have the concept of a user in your own database too.

## Prepare GraphQL mutation

<Vimeo id="392217039" />

## Mutation resolver

<Vimeo id="392217547" />
<Vimeo id="392217658" />

## Create DynamoDB table

Here you'll see me copy paste a dynamodb.ts file from an older project. After reviewing this step I decided to open source that file as a library and recommend you install that instead.

```shell
# in <project>/server
yarn add simple-dynamodb
```

<Vimeo id="392218095" />

## First working test of your resolver

<Vimeo id="392218388" />

## Write mutation to actually upsert

<Vimeo id="392219155" />

## Verify upserting users works

<Vimeo id="392219401" />

## Running mutation in useMutation

<Vimeo id="392220152" />

## Extract logic into custom hooks

<Vimeo id="392244001" />

## How useAuth and useUpdateUser work together

<Vimeo id="392479442" />
